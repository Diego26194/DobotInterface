
tengo esto que es la funcion que corre cuando resibe msg de confirmacion del topico que usa el controlador

# callback del topico planificacion_A_trayectoria
    def _planificacion_callback(self, msg):
        try:
            rospy.loginfo(msg)
            self._last_plan_msg = int(msg.data)
            self._plan_event = True
        except Exception:
            pass

y esta es la funcion que uso para que este nodo espere la confirmacion

def esperar_confirmacion(self, expected, timeout=30.0):
        """Espera a que planificacion_A_trayectoria publique un valor.
        - expected: valor entero esperado. Si es None, se acepta cualquier valor distinto de None.
        - timeout: segundos a esperar antes de fallar.
        Devuelve True si recibi√≥ el esperado, False en caso contrario.
        """
        start = rospy.Time.now()
        rate = rospy.Rate(10)
        self._plan_event = False
        self._last_plan_msg = None

        while (rospy.Time.now() - start).to_sec() < timeout:
            if self._plan_event:
                val = self._last_plan_msg
                # si expected es None, aceptamos cualquier valor
                if expected is None:
                    return True
                if val == expected:
                    return True
                # en caso de error (0) devolvemos False si esperamos otro valor
                if val == 0:
                    return False
                # si llega otro valor lo ignoramos y seguimos esperando
                self._plan_event = False
            try:
                rate.sleep()
            except rospy.ROSInterruptException:
                break
        rospy.logwarn(f"esperar_confirmacion: timeout esperando {expected}")
        return False

al usarlo aca de esta forma

if not self.esperar_confirmacion(0, timeout=30.0):
            rospy.logerr("Error ,rutina no ejecutable. Abortando.")
            self.ejecutando_rutina = False
            return          
        else:
            rospy.logerr("rutina ejecutable")

no esta funcionando, se termina el tiempo y hace que mi proceso termine, ya confirme que el topico esta resibiendo el msg correcto y que "planificacion_callback" si resibe y guarda el dato bien, porque puede ser el error?al mandar un 0?
